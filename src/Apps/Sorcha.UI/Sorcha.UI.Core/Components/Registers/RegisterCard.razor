@* SPDX-License-Identifier: MIT *@
@* Copyright (c) 2025 Sorcha Contributors *@

@using Sorcha.UI.Core.Models.Registers

<MudPaper Elevation="2"
          Class="pa-4 register-card"
          Style="cursor: pointer"
          @onclick="OnCardClick"
          data-testid="register-card"
          data-register-id="@Register.Id">
    <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
        <MudStack Spacing="0" Style="flex: 1; min-width: 0;">
            <MudText Typo="Typo.subtitle1" data-testid="register-name">
                <strong>@Register.Name</strong>
            </MudText>
            @if (!string.IsNullOrWhiteSpace(Register.Description))
            {
                <MudText Typo="Typo.body2" Color="Color.Secondary" Class="text-truncate" data-testid="register-description">
                    @Register.Description
                </MudText>
            }
            <MudText Typo="Typo.caption" Color="Color.Secondary" Class="monospace-text" data-testid="register-id">
                @Register.Id
            </MudText>
        </MudStack>
        <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2" Style="flex-shrink: 0;">
            @if (Register.Advertise)
            {
                <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                    <MudIcon Icon="@Icons.Material.Filled.Public" Size="Size.Small" Color="Color.Info" />
                    <MudText Typo="Typo.caption" Color="Color.Info">Public</MudText>
                </MudStack>
            }
            else
            {
                <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                    <MudIcon Icon="@Icons.Material.Filled.Lock" Size="Size.Small" Color="Color.Secondary" />
                    <MudText Typo="Typo.caption" Color="Color.Secondary">Private</MudText>
                </MudStack>
            }
            <RegisterStatusBadge Status="@Register.Status" />
        </MudStack>
    </MudStack>
</MudPaper>

@code {
    /// <summary>
    /// The register to display
    /// </summary>
    [Parameter]
    public required RegisterViewModel Register { get; set; }

    /// <summary>
    /// Callback when the card is clicked
    /// </summary>
    [Parameter]
    public EventCallback<RegisterViewModel> OnClick { get; set; }

    private async Task OnCardClick()
    {
        await OnClick.InvokeAsync(Register);
    }
}

<style>
    .register-card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }

    .register-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .monospace-text {
        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        font-size: 0.8rem;
    }

    .text-truncate {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>
