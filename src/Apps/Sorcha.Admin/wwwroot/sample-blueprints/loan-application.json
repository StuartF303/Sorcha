{
  "$schema": "https://sorcha.io/schemas/blueprint/v1.0",
  "$id": "https://sorcha.io/blueprints/samples/loan-application",
  "title": "Loan Application Workflow",
  "description": "A sample loan application workflow demonstrating multi-party approval with conditions and calculations",
  "version": "1.0.0",
  "participants": [
    {
      "id": "applicant",
      "name": "Loan Applicant",
      "organisation": "Individual",
      "walletAddress": "",
      "role": "Initiator"
    },
    {
      "id": "loan-officer",
      "name": "Loan Officer",
      "organisation": "First National Bank",
      "walletAddress": "",
      "role": "Approver"
    },
    {
      "id": "credit-analyst",
      "name": "Credit Analyst",
      "organisation": "First National Bank",
      "walletAddress": "",
      "role": "Approver"
    },
    {
      "id": "compliance",
      "name": "Compliance Officer",
      "organisation": "First National Bank",
      "walletAddress": "",
      "role": "Observer"
    }
  ],
  "actions": [
    {
      "id": 1,
      "title": "Submit Loan Application",
      "description": "Applicant submits their loan application with personal and financial information",
      "sender": "applicant",
      "participants": [
        {
          "principal": "loan-officer",
          "role": "Approver"
        }
      ],
      "dataSchemas": [
        {
          "$ref": "https://sorcha.io/schemas/loan-application/v1.0"
        }
      ],
      "next": [2]
    },
    {
      "id": 2,
      "title": "Initial Review",
      "description": "Loan officer performs initial review of the application",
      "sender": "loan-officer",
      "participants": [
        {
          "principal": "credit-analyst",
          "role": "Approver"
        },
        {
          "principal": "compliance",
          "role": "Observer"
        }
      ],
      "conditions": {
        "and": [
          { ">=": [{ "var": "loanAmount" }, 1000] },
          { "<=": [{ "var": "loanAmount" }, 500000] }
        ]
      },
      "next": [3, 4]
    },
    {
      "id": 3,
      "title": "Credit Analysis",
      "description": "Credit analyst reviews creditworthiness and assigns risk score",
      "sender": "credit-analyst",
      "participants": [
        {
          "principal": "loan-officer",
          "role": "Approver"
        }
      ],
      "calculations": [
        {
          "targetField": "riskScore",
          "expression": {
            "+": [
              { "*": [{ "var": "creditScore" }, 0.4] },
              { "*": [{ "var": "incomeRatio" }, 0.3] },
              { "*": [{ "var": "employmentYears" }, 0.3] }
            ]
          }
        }
      ],
      "next": [5]
    },
    {
      "id": 4,
      "title": "Request Additional Documents",
      "description": "Request additional documentation if needed",
      "sender": "loan-officer",
      "participants": [
        {
          "principal": "applicant",
          "role": "Member"
        }
      ],
      "conditions": {
        "<": [{ "var": "documentScore" }, 80]
      },
      "next": [2]
    },
    {
      "id": 5,
      "title": "Final Approval",
      "description": "Final loan approval decision",
      "sender": "loan-officer",
      "participants": [
        {
          "principal": "applicant",
          "role": "Member"
        },
        {
          "principal": "compliance",
          "role": "Observer"
        }
      ],
      "conditions": {
        ">=": [{ "var": "riskScore" }, 70]
      },
      "next": []
    }
  ],
  "metadata": {
    "category": "Finance",
    "tags": ["loan", "approval", "multi-party"],
    "author": "Sorcha Team",
    "createdAt": "2025-01-15T00:00:00Z"
  }
}
